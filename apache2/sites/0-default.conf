<VirtualHost *:80>
  ServerName ci.mydomain.com
    DocumentRoot /var/www/html/

  RewriteEngine on
  RewriteRule ^/(.*) https://ci.mydomain.com/$1 [L,R=301]

</VirtualHost>

<VirtualHost *:443>
  ServerName your.host.com
  DocumentRoot /var/www/html/

  SSLEngine on
  SSLProtocol all -SSLv2 -SSLv3
  SSLCipherSuite ALL:!ADH:!EXPORT:!SSLv2:!RC4:RC4+RSA:+HIGH:+MEDIUM:+LOW
  SSLCertificateFile /etc/letsencrypt/certs/cert.pem
  SSLCertificateKeyFile /etc/letsencrypt/certs/privkey.pem
  SSLCertificateChainFile /etc/letsencrypt/certs/chain.pem
  SetEnvIf User-Agent ".*MSIE.*" nokeepalive ssl-unclean-shutdown

  Proxypass /repo !
  ProxyPass / http://jenkins:8080/ nocanon
  ProxyPassReverse / http://jenkins:8080/
  AllowEncodedSlashes NoDecode

  RewriteEngine on
  RewriteCond %{HTTP_HOST} !^ci\.mydomain\.com$
  RewriteCond %{HTTP_HOST} !^$
  RewriteRule ^/(.*) https://ci.mydomain.com/$1 [L,R]

</VirtualHost>